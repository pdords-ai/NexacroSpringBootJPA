<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Nexacro ê³ ê¸‰ ê¸°ëŠ¥ - ëŒ€ì‹œë³´ë“œì™€ KPI</title>
    <script type="text/javascript" src="http://localhost:8080/nexacro/nexacro.js"></script>
</head>
<body>
    <script type="text/javascript">
        /*
            ===== ëŒ€ì‹œë³´ë“œì™€ KPI ì˜ˆì œ =====
            
            ì´ ì˜ˆì œì—ì„œëŠ” ë‹¤ìŒì„ ë°°ì›ë‹ˆë‹¤:
            1. KPI (í•µì‹¬ ì„±ê³¼ ì§€í‘œ) í‘œì‹œ
            2. ëŒ€ì‹œë³´ë“œ ë ˆì´ì•„ì›ƒ ì„¤ê³„
            3. ì‹¤ì‹œê°„ ë°ì´í„° ëª¨ë‹ˆí„°ë§
            4. ìœ„ì ¯ ê¸°ë°˜ ì¸í„°í˜ì´ìŠ¤
            5. ë°ì´í„° ì‹œê°í™”
            6. ì•Œë¦¼ê³¼ ê²½ê³  ì‹œìŠ¤í…œ
            7. ì‚¬ìš©ì ë§ì¶¤í˜• ëŒ€ì‹œë³´ë“œ
        */
        function on_application_ready() {
            
            /*
                ===== 1ë‹¨ê³„: ë°ì´í„°ì…‹ ì„¤ì • =====
            */
            
            // KPI ë°ì´í„°ì…‹
            var kpiDataset = new nexacro.Dataset("kpiDataset");
            kpiDataset.addColumn("kpiId", "number");
            kpiDataset.addColumn("name", "string");
            kpiDataset.addColumn("currentValue", "number");
            kpiDataset.addColumn("targetValue", "number");
            kpiDataset.addColumn("unit", "string");
            kpiDataset.addColumn("trend", "string");
            kpiDataset.addColumn("status", "string");
            kpiDataset.addColumn("lastUpdate", "string");
            
            // ì‹¤ì‹œê°„ ë°ì´í„°
            var realtimeDataset = new nexacro.Dataset("realtimeDataset");
            realtimeDataset.addColumn("time", "string");
            realtimeDataset.addColumn("value", "number");
            realtimeDataset.addColumn("category", "string");
            
            // ìƒ˜í”Œ KPI ë°ì´í„°
            var sampleKPIs = [
                {kpiId: 1, name: "ì›” ë§¤ì¶œ", currentValue: 25000000, targetValue: 30000000, unit: "ì›", trend: "ìƒìŠ¹", status: "ì–‘í˜¸", lastUpdate: "2024-01-20 14:30"},
                {kpiId: 2, name: "ì‹ ê·œ ê³ ê°", currentValue: 150, targetValue: 200, unit: "ëª…", trend: "í•˜ë½", status: "ì£¼ì˜", lastUpdate: "2024-01-20 14:25"},
                {kpiId: 3, name: "ê³ ê° ë§Œì¡±ë„", currentValue: 4.2, targetValue: 4.5, unit: "ì ", trend: "ìƒìŠ¹", status: "ì–‘í˜¸", lastUpdate: "2024-01-20 14:20"},
                {kpiId: 4, name: "ì£¼ë¬¸ ì²˜ë¦¬ìœ¨", currentValue: 95, targetValue: 98, unit: "%", trend: "í•˜ë½", status: "ê²½ê³ ", lastUpdate: "2024-01-20 14:15"},
                {kpiId: 5, name: "ì¬ê³  íšŒì „ìœ¨", currentValue: 8.5, targetValue: 10, unit: "íšŒ", trend: "ìƒìŠ¹", status: "ì–‘í˜¸", lastUpdate: "2024-01-20 14:10"},
                {kpiId: 6, name: "ì§ì› ë§Œì¡±ë„", currentValue: 3.8, targetValue: 4.0, unit: "ì ", trend: "ìƒìŠ¹", status: "ì£¼ì˜", lastUpdate: "2024-01-20 14:05"}
            ];
            
            // KPI ë°ì´í„° ì¶”ê°€
            for (var i = 0; i < sampleKPIs.length; i++) {
                var kpi = sampleKPIs[i];
                var newRow = kpiDataset.addRow();
                kpiDataset.setCellData(newRow, "kpiId", kpi.kpiId);
                kpiDataset.setCellData(newRow, "name", kpi.name);
                kpiDataset.setCellData(newRow, "currentValue", kpi.currentValue);
                kpiDataset.setCellData(newRow, "targetValue", kpi.targetValue);
                kpiDataset.setCellData(newRow, "unit", kpi.unit);
                kpiDataset.setCellData(newRow, "trend", kpi.trend);
                kpiDataset.setCellData(newRow, "status", kpi.status);
                kpiDataset.setCellData(newRow, "lastUpdate", kpi.lastUpdate);
            }
            
            /*
                ===== 2ë‹¨ê³„: UI ì»´í¬ë„ŒíŠ¸ë“¤ ë§Œë“¤ê¸° =====
            */
            
            // ì œëª©
            var titleLabel = new nexacro.Label("titleLabel");
            titleLabel.set_text("ëŒ€ì‹œë³´ë“œì™€ KPI - ê²½ì˜ í˜„í™© ëª¨ë‹ˆí„°ë§");
            titleLabel.set_left(50);
            titleLabel.set_top(20);
            titleLabel.set_width(800);
            titleLabel.set_height(40);
            titleLabel.set_font("bold 18px Arial");
            titleLabel.set_color("darkblue");
            titleLabel.set_background("lightblue");
            
            // ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼
            var refreshButton = new nexacro.Button("refreshButton");
            refreshButton.set_text("ìƒˆë¡œê³ ì¹¨");
            refreshButton.set_left(870);
            refreshButton.set_top(20);
            refreshButton.set_width(100);
            refreshButton.set_height(40);
            refreshButton.set_background("lightgreen");
            
            // ë©”ì¸ ì»¨í…Œì´ë„ˆ
            var mainContainer = new nexacro.Container("mainContainer");
            mainContainer.set_left(50);
            mainContainer.set_top(70);
            mainContainer.set_width(1000);
            mainContainer.set_height(600);
            mainContainer.set_background("lightgray");
            mainContainer.set_border("2px solid #ccc");
            
            /*
                ===== 3ë‹¨ê³„: KPI ìœ„ì ¯ë“¤ ë§Œë“¤ê¸° =====
            */
            
            // KPI ìœ„ì ¯ 1 - ì›” ë§¤ì¶œ
            var kpiWidget1 = new nexacro.Container("kpiWidget1");
            kpiWidget1.set_left(20);
            kpiWidget1.set_top(20);
            kpiWidget1.set_width(200);
            kpiWidget1.set_height(120);
            kpiWidget1.set_background("white");
            kpiWidget1.set_border("2px solid #4CAF50");
            
            var kpi1Title = new nexacro.Label("kpi1Title");
            kpi1Title.set_text("ì›” ë§¤ì¶œ");
            kpi1Title.set_left(10);
            kpi1Title.set_top(10);
            kpi1Title.set_width(180);
            kpi1Title.set_height(25);
            kpi1Title.set_font("bold 14px Arial");
            kpi1Title.set_color("darkgreen");
            
            var kpi1Value = new nexacro.Label("kpi1Value");
            kpi1Value.set_text("25,000,000ì›");
            kpi1Value.set_left(10);
            kpi1Value.set_top(40);
            kpi1Value.set_width(180);
            kpi1Value.set_height(30);
            kpi1Value.set_font("bold 18px Arial");
            kpi1Value.set_color("darkgreen");
            
            var kpi1Target = new nexacro.Label("kpi1Target");
            kpi1Target.set_text("ëª©í‘œ: 30,000,000ì› (83%)");
            kpi1Target.set_left(10);
            kpi1Target.set_top(75);
            kpi1Target.set_width(180);
            kpi1Target.set_height(20);
            kpi1Target.set_font("12px Arial");
            kpi1Target.set_color("gray");
            
            var kpi1Trend = new nexacro.Label("kpi1Trend");
            kpi1Trend.set_text("ğŸ“ˆ ìƒìŠ¹");
            kpi1Trend.set_left(10);
            kpi1Trend.set_top(95);
            kpi1Trend.set_width(180);
            kpi1Trend.set_height(20);
            kpi1Trend.set_font("12px Arial");
            kpi1Trend.set_color("green");
            
            // KPI ìœ„ì ¯ 2 - ì‹ ê·œ ê³ ê°
            var kpiWidget2 = new nexacro.Container("kpiWidget2");
            kpiWidget2.set_left(240);
            kpiWidget2.set_top(20);
            kpiWidget2.set_width(200);
            kpiWidget2.set_height(120);
            kpiWidget2.set_background("white");
            kpiWidget2.set_border("2px solid #FF9800");
            
            var kpi2Title = new nexacro.Label("kpi2Title");
            kpi2Title.set_text("ì‹ ê·œ ê³ ê°");
            kpi2Title.set_left(10);
            kpi2Title.set_top(10);
            kpi2Title.set_width(180);
            kpi2Title.set_height(25);
            kpi2Title.set_font("bold 14px Arial");
            kpi2Title.set_color("darkorange");
            
            var kpi2Value = new nexacro.Label("kpi2Value");
            kpi2Value.set_text("150ëª…");
            kpi2Value.set_left(10);
            kpi2Value.set_top(40);
            kpi2Value.set_width(180);
            kpi2Value.set_height(30);
            kpi2Value.set_font("bold 18px Arial");
            kpi2Value.set_color("darkorange");
            
            var kpi2Target = new nexacro.Label("kpi2Target");
            kpi2Target.set_text("ëª©í‘œ: 200ëª… (75%)");
            kpi2Target.set_left(10);
            kpi2Target.set_top(75);
            kpi2Target.set_width(180);
            kpi2Target.set_height(20);
            kpi2Target.set_font("12px Arial");
            kpi2Target.set_color("gray");
            
            var kpi2Trend = new nexacro.Label("kpi2Trend");
            kpi2Trend.set_text("ğŸ“‰ í•˜ë½");
            kpi2Trend.set_left(10);
            kpi2Trend.set_top(95);
            kpi2Trend.set_width(180);
            kpi2Trend.set_height(20);
            kpi2Trend.set_font("12px Arial");
            kpi2Trend.set_color("red");
            
            // KPI ìœ„ì ¯ 3 - ê³ ê° ë§Œì¡±ë„
            var kpiWidget3 = new nexacro.Container("kpiWidget3");
            kpiWidget3.set_left(460);
            kpiWidget3.set_top(20);
            kpiWidget3.set_width(200);
            kpiWidget3.set_height(120);
            kpiWidget3.set_background("white");
            kpiWidget3.set_border("2px solid #2196F3");
            
            var kpi3Title = new nexacro.Label("kpi3Title");
            kpi3Title.set_text("ê³ ê° ë§Œì¡±ë„");
            kpi3Title.set_left(10);
            kpi3Title.set_top(10);
            kpi3Title.set_width(180);
            kpi3Title.set_height(25);
            kpi3Title.set_font("bold 14px Arial");
            kpi3Title.set_color("darkblue");
            
            var kpi3Value = new nexacro.Label("kpi3Value");
            kpi3Value.set_text("4.2ì ");
            kpi3Value.set_left(10);
            kpi3Value.set_top(40);
            kpi3Value.set_width(180);
            kpi3Value.set_height(30);
            kpi3Value.set_font("bold 18px Arial");
            kpi3Value.set_color("darkblue");
            
            var kpi3Target = new nexacro.Label("kpi3Target");
            kpi3Target.set_text("ëª©í‘œ: 4.5ì  (93%)");
            kpi3Target.set_left(10);
            kpi3Target.set_top(75);
            kpi3Target.set_width(180);
            kpi3Target.set_height(20);
            kpi3Target.set_font("12px Arial");
            kpi3Target.set_color("gray");
            
            var kpi3Trend = new nexacro.Label("kpi3Trend");
            kpi3Trend.set_text("ğŸ“ˆ ìƒìŠ¹");
            kpi3Trend.set_left(10);
            kpi3Trend.set_top(95);
            kpi3Trend.set_width(180);
            kpi3Trend.set_height(20);
            kpi3Trend.set_font("12px Arial");
            kpi3Trend.set_color("green");
            
            // KPI ìœ„ì ¯ 4 - ì£¼ë¬¸ ì²˜ë¦¬ìœ¨
            var kpiWidget4 = new nexacro.Container("kpiWidget4");
            kpiWidget4.set_left(680);
            kpiWidget4.set_top(20);
            kpiWidget4.set_width(200);
            kpiWidget4.set_height(120);
            kpiWidget4.set_background("white");
            kpiWidget4.set_border("2px solid #F44336");
            
            var kpi4Title = new nexacro.Label("kpi4Title");
            kpi4Title.set_text("ì£¼ë¬¸ ì²˜ë¦¬ìœ¨");
            kpi4Title.set_left(10);
            kpi4Title.set_top(10);
            kpi4Title.set_width(180);
            kpi4Title.set_height(25);
            kpi4Title.set_font("bold 14px Arial");
            kpi4Title.set_color("darkred");
            
            var kpi4Value = new nexacro.Label("kpi4Value");
            kpi4Value.set_text("95%");
            kpi4Value.set_left(10);
            kpi4Value.set_top(40);
            kpi4Value.set_width(180);
            kpi4Value.set_height(30);
            kpi4Value.set_font("bold 18px Arial");
            kpi4Value.set_color("darkred");
            
            var kpi4Target = new nexacro.Label("kpi4Target");
            kpi4Target.set_text("ëª©í‘œ: 98% (97%)");
            kpi4Target.set_left(10);
            kpi4Target.set_top(75);
            kpi4Target.set_width(180);
            kpi4Target.set_height(20);
            kpi4Target.set_font("12px Arial");
            kpi4Target.set_color("gray");
            
            var kpi4Trend = new nexacro.Label("kpi4Trend");
            kpi4Trend.set_text("ğŸ“‰ í•˜ë½");
            kpi4Trend.set_left(10);
            kpi4Trend.set_top(95);
            kpi4Trend.set_width(180);
            kpi4Trend.set_height(20);
            kpi4Trend.set_font("12px Arial");
            kpi4Trend.set_color("red");
            
            /*
                ===== 4ë‹¨ê³„: ì°¨íŠ¸ ìœ„ì ¯ë“¤ ë§Œë“¤ê¸° =====
            */
            
            // ë§¤ì¶œ ì¶”ì´ ì°¨íŠ¸
            var chartWidget1 = new nexacro.Container("chartWidget1");
            chartWidget1.set_left(20);
            chartWidget1.set_top(160);
            chartWidget1.set_width(400);
            chartWidget1.set_height(200);
            chartWidget1.set_background("white");
            chartWidget1.set_border("1px solid #ccc");
            
            var chart1Title = new nexacro.Label("chart1Title");
            chart1Title.set_text("ğŸ“Š ì›”ë³„ ë§¤ì¶œ ì¶”ì´");
            chart1Title.set_left(10);
            chart1Title.set_top(10);
            chart1Title.set_width(380);
            chart1Title.set_height(25);
            chart1Title.set_font("bold 14px Arial");
            chart1Title.set_background("lightblue");
            
            var chart1Area = new nexacro.Label("chart1Area");
            chart1Area.set_text("ğŸ“ˆ ë§¤ì¶œ ì¶”ì´ ì°¨íŠ¸\n\n" +
                              "1ì›”: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 1,200ë§Œì›\n" +
                              "2ì›”: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 1,500ë§Œì›\n" +
                              "3ì›”: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 1,800ë§Œì›\n" +
                              "4ì›”: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 1,600ë§Œì›\n" +
                              "5ì›”: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 2,000ë§Œì›\n" +
                              "6ì›”: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 2,200ë§Œì›\n" +
                              "7ì›”: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 1,900ë§Œì›\n" +
                              "8ì›”: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 2,100ë§Œì›\n" +
                              "9ì›”: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 2,300ë§Œì›\n" +
                              "10ì›”: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 2,500ë§Œì›");
            chart1Area.set_left(10);
            chart1Area.set_top(40);
            chart1Area.set_width(380);
            chart1Area.set_height(150);
            chart1Area.set_background("lightyellow");
            chart1Area.set_border("1px solid #ccc");
            chart1Area.set_font("12px Arial");
            
            // ê³ ê° ë¶„ì„ ì°¨íŠ¸
            var chartWidget2 = new nexacro.Container("chartWidget2");
            chartWidget2.set_left(440);
            chartWidget2.set_top(160);
            chartWidget2.set_width(400);
            chartWidget2.set_height(200);
            chartWidget2.set_background("white");
            chartWidget2.set_border("1px solid #ccc");
            
            var chart2Title = new nexacro.Label("chart2Title");
            chart2Title.set_text("ğŸ‘¥ ê³ ê° ë¶„ì„");
            chart2Title.set_left(10);
            chart2Title.set_top(10);
            chart2Title.set_width(380);
            chart2Title.set_height(25);
            chart2Title.set_font("bold 14px Arial");
            chart2Title.set_background("lightgreen");
            
            var chart2Area = new nexacro.Label("chart2Area");
            chart2Area.set_text("ğŸ¥§ ê³ ê° ë¶„í¬ (ì›í˜• ì°¨íŠ¸)\n\n" +
                              "ì‹ ê·œ ê³ ê°: â—â—â—â—â—â—â—â—â—â— 35%\n" +
                              "ê¸°ì¡´ ê³ ê°: â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â— 45%\n" +
                              "VIP ê³ ê°: â—â—â—â—â— 15%\n" +
                              "íƒˆí‡´ ê³ ê°: â—â— 5%\n\n" +
                              "ğŸ“Š ê³ ê° ë§Œì¡±ë„: 4.2/5.0\n" +
                              "ğŸ”„ ì¬êµ¬ë§¤ìœ¨: 78%\n" +
                              "ğŸ’¬ ë¦¬ë·° ìˆ˜: 1,234ê°œ");
            chart2Area.set_left(10);
            chart2Area.set_top(40);
            chart2Area.set_width(380);
            chart2Area.set_height(150);
            chart2Area.set_background("lightcyan");
            chart2Area.set_border("1px solid #ccc");
            chart2Area.set_font("12px Arial");
            
            /*
                ===== 5ë‹¨ê³„: ì•Œë¦¼ ìœ„ì ¯ =====
            */
            var alertWidget = new nexacro.Container("alertWidget");
            alertWidget.set_left(860);
            alertWidget.set_top(160);
            alertWidget.set_width(120);
            alertWidget.set_height(200);
            alertWidget.set_background("white");
            alertWidget.set_border("1px solid #ccc");
            
            var alertTitle = new nexacro.Label("alertTitle");
            alertTitle.set_text("ğŸš¨ ì•Œë¦¼");
            alertTitle.set_left(10);
            alertTitle.set_top(10);
            alertTitle.set_width(100);
            alertTitle.set_height(25);
            alertTitle.set_font("bold 14px Arial");
            alertTitle.set_background("lightcoral");
            
            var alertArea = new nexacro.Label("alertArea");
            alertArea.set_text("âš ï¸ ì£¼ë¬¸ ì²˜ë¦¬ìœ¨ í•˜ë½\n" +
                             "ğŸ“‰ ì‹ ê·œ ê³ ê° ê°ì†Œ\n" +
                             "âœ… ë§¤ì¶œ ëª©í‘œ ë‹¬ì„±\n" +
                             "ğŸ“ˆ ê³ ê° ë§Œì¡±ë„ ìƒìŠ¹\n" +
                             "ğŸ”„ ì¬ê³  íšŒì „ìœ¨ ì–‘í˜¸");
            alertArea.set_left(10);
            alertArea.set_top(40);
            alertArea.set_width(100);
            alertArea.set_height(150);
            alertArea.set_background("lightyellow");
            alertArea.set_border("1px solid #ccc");
            alertArea.set_font("10px Arial");
            
            /*
                ===== 6ë‹¨ê³„: ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ ìœ„ì ¯ =====
            */
            var monitorWidget = new nexacro.Container("monitorWidget");
            monitorWidget.set_left(20);
            monitorWidget.set_top(380);
            monitorWidget.set_width(960);
            monitorWidget.set_height(180);
            monitorWidget.set_background("white");
            monitorWidget.set_border("1px solid #ccc");
            
            var monitorTitle = new nexacro.Label("monitorTitle");
            monitorTitle.set_text("ğŸ“¡ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§");
            monitorTitle.set_left(10);
            monitorTitle.set_top(10);
            monitorTitle.set_width(940);
            monitorTitle.set_height(25);
            monitorTitle.set_font("bold 14px Arial");
            monitorTitle.set_background("lightblue");
            
            var monitorArea = new nexacro.Label("monitorArea");
            monitorArea.set_text("ì‹¤ì‹œê°„ ë°ì´í„°ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤");
            monitorArea.set_left(10);
            monitorArea.set_top(40);
            monitorArea.set_width(940);
            monitorArea.set_height(130);
            monitorArea.set_background("lightgray");
            monitorArea.set_border("1px solid #ccc");
            monitorArea.set_font("12px Arial");
            
            /*
                ===== 7ë‹¨ê³„: ëŒ€ì‹œë³´ë“œ í•¨ìˆ˜ë“¤ =====
            */
            
            var isRealtimeActive = false;
            var realtimeInterval;
            
            /*
                KPI ë°ì´í„° ì—…ë°ì´íŠ¸
            */
            function updateKPIData() {
                // ì‹¤ì œë¡œëŠ” ì„œë²„ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ì§€ë§Œ, ì—¬ê¸°ì„œëŠ” ì‹œë®¬ë ˆì´ì…˜
                for (var i = 0; i < kpiDataset.getRowCount(); i++) {
                    var currentValue = kpiDataset.getCellData(i, "currentValue");
                    var trend = kpiDataset.getCellData(i, "trend");
                    
                    // ëœë¤í•˜ê²Œ ê°’ ë³€ê²½
                    var change = (Math.random() - 0.5) * 0.1; // Â±5% ë³€í™”
                    var newValue = currentValue * (1 + change);
                    
                    kpiDataset.setCellData(i, "currentValue", Math.round(newValue));
                    kpiDataset.setCellData(i, "lastUpdate", new Date().toLocaleString());
                }
                
                updateKPIWidgets();
            }
            
            /*
                KPI ìœ„ì ¯ ì—…ë°ì´íŠ¸
            */
            function updateKPIWidgets() {
                // ì›” ë§¤ì¶œ ì—…ë°ì´íŠ¸
                var salesValue = kpiDataset.getCellData(0, "currentValue");
                var salesTarget = kpiDataset.getCellData(0, "targetValue");
                var salesPercent = Math.round((salesValue / salesTarget) * 100);
                kpi1Value.set_text(salesValue.toLocaleString() + "ì›");
                kpi1Target.set_text("ëª©í‘œ: " + salesTarget.toLocaleString() + "ì› (" + salesPercent + "%)");
                
                // ì‹ ê·œ ê³ ê° ì—…ë°ì´íŠ¸
                var customerValue = kpiDataset.getCellData(1, "currentValue");
                var customerTarget = kpiDataset.getCellData(1, "targetValue");
                var customerPercent = Math.round((customerValue / customerTarget) * 100);
                kpi2Value.set_text(customerValue + "ëª…");
                kpi2Target.set_text("ëª©í‘œ: " + customerTarget + "ëª… (" + customerPercent + "%)");
                
                // ê³ ê° ë§Œì¡±ë„ ì—…ë°ì´íŠ¸
                var satisfactionValue = kpiDataset.getCellData(2, "currentValue");
                var satisfactionTarget = kpiDataset.getCellData(2, "targetValue");
                var satisfactionPercent = Math.round((satisfactionValue / satisfactionTarget) * 100);
                kpi3Value.set_text(satisfactionValue + "ì ");
                kpi3Target.set_text("ëª©í‘œ: " + satisfactionTarget + "ì  (" + satisfactionPercent + "%)");
                
                // ì£¼ë¬¸ ì²˜ë¦¬ìœ¨ ì—…ë°ì´íŠ¸
                var processValue = kpiDataset.getCellData(3, "currentValue");
                var processTarget = kpiDataset.getCellData(3, "targetValue");
                var processPercent = Math.round((processValue / processTarget) * 100);
                kpi4Value.set_text(processValue + "%");
                kpi4Target.set_text("ëª©í‘œ: " + processTarget + "% (" + processPercent + "%)");
            }
            
            /*
                ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ ì‹œì‘/ì¤‘ì§€
            */
            function toggleRealtimeMonitoring() {
                if (isRealtimeActive) {
                    clearInterval(realtimeInterval);
                    refreshButton.set_text("ì‹¤ì‹œê°„ ì‹œì‘");
                    refreshButton.set_background("lightgreen");
                    isRealtimeActive = false;
                    monitorArea.set_text("ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ì´ ì¤‘ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.");
                } else {
                    realtimeInterval = setInterval(function() {
                        updateKPIData();
                        updateRealtimeMonitor();
                    }, 3000); // 3ì´ˆë§ˆë‹¤ ì—…ë°ì´íŠ¸
                    
                    refreshButton.set_text("ì‹¤ì‹œê°„ ì¤‘ì§€");
                    refreshButton.set_background("lightcoral");
                    isRealtimeActive = true;
                }
            }
            
            /*
                ì‹¤ì‹œê°„ ëª¨ë‹ˆí„° ì—…ë°ì´íŠ¸
            */
            function updateRealtimeMonitor() {
                var currentTime = new Date().toLocaleTimeString();
                var monitorText = "ğŸ• " + currentTime + " - ì‹¤ì‹œê°„ ë°ì´í„° ì—…ë°ì´íŠ¸\n\n";
                
                monitorText += "ğŸ“Š í˜„ì¬ KPI ìƒíƒœ:\n";
                for (var i = 0; i < kpiDataset.getRowCount(); i++) {
                    var name = kpiDataset.getCellData(i, "name");
                    var value = kpiDataset.getCellData(i, "currentValue");
                    var unit = kpiDataset.getCellData(i, "unit");
                    var status = kpiDataset.getCellData(i, "status");
                    
                    var statusIcon = "";
                    switch (status) {
                        case "ì–‘í˜¸": statusIcon = "âœ…"; break;
                        case "ì£¼ì˜": statusIcon = "âš ï¸"; break;
                        case "ê²½ê³ ": statusIcon = "ğŸš¨"; break;
                    }
                    
                    monitorText += statusIcon + " " + name + ": " + value + unit + "\n";
                }
                
                monitorText += "\nğŸ“ˆ ìµœê·¼ ì—…ë°ì´íŠ¸: " + new Date().toLocaleString();
                monitorArea.set_text(monitorText);
            }
            
            /*
                ì•Œë¦¼ ì—…ë°ì´íŠ¸
            */
            function updateAlerts() {
                var alertText = "";
                var alertCount = 0;
                
                for (var i = 0; i < kpiDataset.getRowCount(); i++) {
                    var name = kpiDataset.getCellData(i, "name");
                    var status = kpiDataset.getCellData(i, "status");
                    var trend = kpiDataset.getCellData(i, "trend");
                    
                    if (status === "ê²½ê³ ") {
                        alertText += "ğŸš¨ " + name + " ê²½ê³ \n";
                        alertCount++;
                    } else if (status === "ì£¼ì˜") {
                        alertText += "âš ï¸ " + name + " ì£¼ì˜\n";
                        alertCount++;
                    }
                }
                
                if (alertCount === 0) {
                    alertText = "âœ… ëª¨ë“  ì§€í‘œ ì •ìƒ\n" +
                              "ğŸ“ˆ ë§¤ì¶œ ìƒìŠ¹ ì¶”ì„¸\n" +
                              "ğŸ‘¥ ê³ ê° ë§Œì¡±ë„ ì–‘í˜¸\n" +
                              "ğŸ”„ ì‹œìŠ¤í…œ ì •ìƒ ìš´ì˜";
                }
                
                alertArea.set_text(alertText);
            }
            
            /*
                ===== 8ë‹¨ê³„: ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì—°ê²° =====
            */
            
            refreshButton.addEventHandler("onclick", function() {
                if (isRealtimeActive) {
                    toggleRealtimeMonitoring();
                } else {
                    updateKPIData();
                    updateKPIWidgets();
                    updateAlerts();
                    updateRealtimeMonitor();
                }
            });
            
            /*
                ===== 9ë‹¨ê³„: ì´ˆê¸° ì„¤ì • =====
            */
            updateKPIWidgets();
            updateAlerts();
            updateRealtimeMonitor();
            
            /*
                ===== 10ë‹¨ê³„: ëª¨ë“  ì»´í¬ë„ŒíŠ¸ë¥¼ í™”ë©´ì— ì¶”ê°€ =====
            */
            this.add(titleLabel);
            this.add(refreshButton);
            this.add(mainContainer);
            this.add(kpiWidget1);
            this.add(kpi1Title);
            this.add(kpi1Value);
            this.add(kpi1Target);
            this.add(kpi1Trend);
            this.add(kpiWidget2);
            this.add(kpi2Title);
            this.add(kpi2Value);
            this.add(kpi2Target);
            this.add(kpi2Trend);
            this.add(kpiWidget3);
            this.add(kpi3Title);
            this.add(kpi3Value);
            this.add(kpi3Target);
            this.add(kpi3Trend);
            this.add(kpiWidget4);
            this.add(kpi4Title);
            this.add(kpi4Value);
            this.add(kpi4Target);
            this.add(kpi4Trend);
            this.add(chartWidget1);
            this.add(chart1Title);
            this.add(chart1Area);
            this.add(chartWidget2);
            this.add(chart2Title);
            this.add(chart2Area);
            this.add(alertWidget);
            this.add(alertTitle);
            this.add(alertArea);
            this.add(monitorWidget);
            this.add(monitorTitle);
            this.add(monitorArea);
            
            /*
                ===== ì •ë¦¬ =====
                ì´ ì˜ˆì œì—ì„œ ë°°ìš´ ëŒ€ì‹œë³´ë“œì™€ KPI ê¸°ëŠ¥ë“¤:
                
                1. KPI (í•µì‹¬ ì„±ê³¼ ì§€í‘œ) í‘œì‹œ:
                   - í˜„ì¬ ê°’ê³¼ ëª©í‘œ ê°’ ë¹„êµ
                   - ë‹¬ì„±ë¥  ê³„ì‚° ë° í‘œì‹œ
                   - íŠ¸ë Œë“œ ë¶„ì„ (ìƒìŠ¹/í•˜ë½)
                   - ìƒíƒœë³„ ìƒ‰ìƒ êµ¬ë¶„
                
                2. ëŒ€ì‹œë³´ë“œ ë ˆì´ì•„ì›ƒ:
                   - ìœ„ì ¯ ê¸°ë°˜ ì¸í„°í˜ì´ìŠ¤
                   - ë°˜ì‘í˜• ë ˆì´ì•„ì›ƒ
                   - ì‹œê°ì  ê³„ì¸µ êµ¬ì¡°
                   - ì‚¬ìš©ì ì¹œí™”ì  ë””ìì¸
                
                3. ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§:
                   - ìë™ ë°ì´í„° ì—…ë°ì´íŠ¸
                   - ì‹¤ì‹œê°„ ìƒíƒœ í‘œì‹œ
                   - ì•Œë¦¼ ì‹œìŠ¤í…œ
                   - ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
                
                4. ë°ì´í„° ì‹œê°í™”:
                   - ì°¨íŠ¸ì™€ ê·¸ë˜í”„
                   - í…ìŠ¤íŠ¸ ê¸°ë°˜ ì‹œê°í™”
                   - ìƒ‰ìƒ ì½”ë”©
                   - ì•„ì´ì½˜ í™œìš©
                
                5. ì•Œë¦¼ ì‹œìŠ¤í…œ:
                   - ìƒíƒœë³„ ì•Œë¦¼
                   - ê²½ê³  ë° ì£¼ì˜ ë©”ì‹œì§€
                   - ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
                   - ì‹œê°ì  í”¼ë“œë°±
                
                6. ì‚¬ìš©ì ê²½í—˜:
                   - ì§ê´€ì ì¸ ì¸í„°í˜ì´ìŠ¤
                   - ë¹ ë¥¸ ì •ë³´ íŒŒì•…
                   - ë°˜ì‘í˜• í”¼ë“œë°±
                   - ì ‘ê·¼ì„± ê³ ë ¤
                
                ì‹¤ì œ í”„ë¡œì íŠ¸ì—ì„œëŠ”:
                - ì „ë¬¸ ì°¨íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©
                - ì„œë²„ì™€ì˜ ì‹¤ì‹œê°„ ì—°ë™
                - ë” ë³µì¡í•œ KPI ê³„ì‚°
                - ì‚¬ìš©ì ë§ì¶¤í˜• ëŒ€ì‹œë³´ë“œ
                - ëª¨ë°”ì¼ ì§€ì›
                - ë°ì´í„° ë‚´ë³´ë‚´ê¸°
                - ì•Œë¦¼ ì„¤ì •
                
                ì´ì œ ê²½ì˜ì§„ì„ ìœ„í•œ ì „ë¬¸ì ì¸ ëŒ€ì‹œë³´ë“œë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤!
            */
        }
    </script>
</body>
</html>
